<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>opeansearch 支持的sql类型</title>
</head>
<body>
<div id="wmd-preview" class="wmd-preview"><div class="md-section-divider"></div><p data-anchor-id="x9l3"><div class="toc">
<ul>
<li><a href="#opeansearch-支持的sql类型">opeansearch 支持的sql类型</a><ul>
<li><a href="#目前opeansearch支持的分词类型">目前opeansearch支持的分词类型</a></li>
<li><a href="#查询对比">查询对比</a><ul>
<li><a href="#说明">说明</a></li>
<li><a href="#eq-查询">EQ 查询</a><ul>
<li><a href="#标准sql查询">标准sql查询</a></li>
<li><a href="#不分词">不分词</a></li>
<li><a href="#模糊分词">模糊分词</a></li>
<li><a href="#拼音分词">拼音分词</a></li>
<li><a href="#ik分词">IK分词</a></li>
</ul>
</li>
<li><a href="#like-查询">like 查询</a><ul>
<li><a href="#标准sql查询-1">标准sql查询</a></li>
<li><a href="#不分词-1">不分词</a></li>
<li><a href="#模糊分词-1">模糊分词</a></li>
<li><a href="#拼音分词-1">拼音分词</a></li>
<li><a href="#ik分词-1">IK分词</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#不等于">不等于</a></li>
<li><a href="#gtgteltlte">GT,GTE,LT,LTE</a></li>
<li><a href="#between-and">between and</a></li>
<li><a href="#in">in</a></li>
<li><a href="#is-null-is-not-null">is null is not null</a></li>
<li><a href="#聚合">聚合</a></li>
<li><a href="#minmaxavgsumcount">min,max,avg,sum,count</a></li>
<li><a href="#stats">stats</a></li>
<li><a href="#percentiles-百分比">percentiles 百分比</a><ul>
<li><ul>
<li><a href="#根据区间聚合">根据区间聚合</a></li>
<li><a href="#根据时间区间聚合">根据时间区间聚合</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</p><div class="md-section-divider"></div><h1 data-anchor-id="hn20" id="opeansearch-支持的sql类型">opeansearch 支持的sql类型</h1><p data-anchor-id="xys7"><strong>目前只支持单表查询</strong></p><div class="md-section-divider"></div><h2 data-anchor-id="4kh6" id="目前opeansearch支持的分词类型">目前opeansearch支持的分词类型</h2><ul data-anchor-id="sbfu">
<li>不分词</li>
<li>模糊分词</li>
<li>拼音分词</li>
<li>IK分词</li>
</ul><div class="md-section-divider"></div><h2 data-anchor-id="yaz1" id="查询对比">查询对比</h2><div class="md-section-divider"></div><h3 data-anchor-id="an95" id="说明">说明</h3><ul data-anchor-id="8mdt">
<li>如果字段都是精确查询，索引字段请选择不分词。</li>
<li>如果字段需要模糊查询，但是在某些场景下需要精确查询，查询的时候，请使用<code>字段名.raw</code>作为条件。</li>
<li>对于分词的字段进行聚合，如<code>group by,sort</code>等操作的时候，请使用<code>字段名.raw</code>作为聚合条件</li>
</ul><div class="md-section-divider"></div><h3 data-anchor-id="joh5" id="eq-查询">EQ 查询</h3><div class="md-section-divider"></div><h4 data-anchor-id="tztv" id="标准sql查询">标准sql查询</h4><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="brlf"><ol class="linenums"><li class="L0"><code class="language-sql"><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span><span class="kwd">where</span><span class="pln"> name</span><span class="pun">=</span><span class="str">'数据检索'</span></code></li></ol></pre><div class="md-section-divider"></div><h4 data-anchor-id="l3a5" id="不分词">不分词</h4><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="crfx"><ol class="linenums"><li class="L0"><code class="language-sql"><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span><span class="kwd">where</span><span class="pln"> name</span><span class="pun">=</span><span class="str">'数据检索'</span></code></li></ol></pre><div class="md-section-divider"></div><h4 data-anchor-id="ex99" id="模糊分词">模糊分词</h4><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="1ve6"><ol class="linenums"><li class="L0"><code class="language-sql"><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span><span class="kwd">where</span><span class="pln"> name</span><span class="pun">=</span><span class="pln">term</span><span class="pun">(</span><span class="str">'数据检索'</span><span class="pun">)</span></code></li></ol></pre><div class="md-section-divider"></div><h4 data-anchor-id="bg5d" id="拼音分词">拼音分词</h4><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="fg1c"><ol class="linenums"><li class="L0"><code class="language-sql"><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span><span class="kwd">where</span><span class="pln"> name</span><span class="pun">=</span><span class="pln">term</span><span class="pun">(</span><span class="str">'shujujiansuo'</span><span class="pun">)</span></code></li><li class="L1"><code class="language-sql"><span class="pun">--</span><span class="pln"> </span><span class="pun">或者</span></code></li><li class="L2"><code class="language-sql"><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span><span class="kwd">where</span><span class="pln"> name</span><span class="pun">=</span><span class="pln">term</span><span class="pun">(</span><span class="str">'sjjs'</span><span class="pun">)</span></code></li></ol></pre><div class="md-section-divider"></div><h4 data-anchor-id="oeq4" id="ik分词">IK分词</h4><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="olmr"><ol class="linenums"><li class="L0"><code class="language-sql"><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span><span class="kwd">where</span><span class="pln"> name</span><span class="pun">=</span><span class="pln">matchquery</span><span class="pun">(</span><span class="str">'数据检索'</span><span class="pun">)</span></code></li></ol></pre><div class="md-section-divider"></div><h3 data-anchor-id="8xn2" id="like-查询">like 查询</h3><div class="md-section-divider"></div><h4 data-anchor-id="xdp0" id="标准sql查询-1">标准sql查询</h4><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="7qci"><ol class="linenums"><li class="L0"><code class="language-sql"><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span><span class="kwd">where</span><span class="pln"> name like </span><span class="str">'数据%'</span></code></li></ol></pre><div class="md-section-divider"></div><h4 data-anchor-id="t3eo" id="不分词-1">不分词</h4><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="7p29"><ol class="linenums"><li class="L0"><code class="language-sql"><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span><span class="kwd">where</span><span class="pln"> name like </span><span class="str">'数据%'</span></code></li></ol></pre><div class="md-section-divider"></div><h4 data-anchor-id="571y" id="模糊分词-1">模糊分词</h4><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="4yv0"><ol class="linenums"><li class="L0"><code class="language-sql"><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span><span class="kwd">where</span><span class="pln"> name</span><span class="pun">=</span><span class="pln">term</span><span class="pun">(</span><span class="str">'数据'</span><span class="pun">)</span></code></li></ol></pre><div class="md-section-divider"></div><h4 data-anchor-id="40ix" id="拼音分词-1">拼音分词</h4><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="lj19"><ol class="linenums"><li class="L0"><code class="language-sql"><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span><span class="kwd">where</span><span class="pln"> name</span><span class="pun">=</span><span class="pln">term</span><span class="pun">(</span><span class="str">'shuju'</span><span class="pun">)</span></code></li><li class="L1"><code class="language-sql"><span class="pun">--</span><span class="pln"> </span><span class="pun">或者</span></code></li><li class="L2"><code class="language-sql"><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span><span class="kwd">where</span><span class="pln"> name</span><span class="pun">=</span><span class="pln">term</span><span class="pun">(</span><span class="str">'sj'</span><span class="pun">)</span></code></li></ol></pre><div class="md-section-divider"></div><h4 data-anchor-id="fe88" id="ik分词-1">IK分词</h4><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="8mn6"><ol class="linenums"><li class="L0"><code class="language-sql"><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span><span class="kwd">where</span><span class="pln"> name</span><span class="pun">=</span><span class="pln">matchquery</span><span class="pun">(</span><span class="str">'数据'</span><span class="pun">)</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="50pi" id="不等于">不等于</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="7rhh"><ol class="linenums"><li class="L0"><code class="language-sql"><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span><span class="kwd">where</span><span class="pln"> age </span><span class="pun">&lt;&gt;</span><span class="pln"> </span><span class="lit">20</span></code></li><li class="L1"><code class="language-sql"></code></li><li class="L2"><code class="language-sql"><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span><span class="kwd">where</span><span class="pln"> age </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> </span><span class="lit">20</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="l2yi" id="gtgteltlte">GT,GTE,LT,LTE</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="kuz7"><ol class="linenums"><li class="L0"><code class="language-sql"><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span><span class="kwd">where</span><span class="pln"> age </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">20</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> age </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">30</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="r7uh" id="between-and">between and</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="7t3n"><ol class="linenums"><li class="L0"><code class="language-sql"><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span><span class="kwd">where</span><span class="pln"> age between </span><span class="lit">20</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> </span><span class="lit">30</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="rue8" id="in">in</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="clu8"><ol class="linenums"><li class="L0"><code class="language-sql"><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span><span class="kwd">where</span><span class="pln"> age </span><span class="kwd">in</span><span class="pun">(</span><span class="lit">20</span><span class="pun">,</span><span class="lit">30</span><span class="pun">)</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="4jwp" id="is-null-is-not-null">is null is not null</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="8az9"><ol class="linenums"><li class="L0"><code class="language-sql"><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span><span class="kwd">where</span><span class="pln"> name </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">null</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="8cjx" id="聚合">聚合</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="nyli"><ol class="linenums"><li class="L0"><code class="language-sql"><span class="kwd">select</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span><span class="kwd">group</span><span class="pln"> </span><span class="kwd">by</span><span class="pln"> dept</span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="blqh" id="minmaxavgsumcount">min,max,avg,sum,count</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="5b35"><ol class="linenums"><li class="L0"><code class="language-sql"><span class="kwd">select</span><span class="pln"> avg</span><span class="pun">(</span><span class="pln">age</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="3fvr" id="stats">stats</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="mqkf"><ol class="linenums"><li class="L0"><code class="language-sql"><span class="kwd">select</span><span class="pln"> stats</span><span class="pun">(</span><span class="pln">age</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span></code></li></ol></pre><div class="md-section-divider"></div><h2 data-anchor-id="lyoe" id="percentiles-百分比">percentiles 百分比</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="ptmd"><ol class="linenums"><li class="L0"><code class="language-sql"><span class="kwd">select</span><span class="pln"> percentiles</span><span class="pun">(</span><span class="pln">age</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">from</span><span class="pln">  user </span></code></li></ol></pre><div class="md-section-divider"></div><h4 data-anchor-id="7jtq" id="根据区间聚合">根据区间聚合</h4><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="47sz"><ol class="linenums"><li class="L0"><code><span class="pln"> SELECT COUNT</span><span class="pun">(</span><span class="pln">age</span><span class="pun">)</span><span class="pln">  bank GROUP BY range</span><span class="pun">(</span><span class="pln">age</span><span class="pun">,</span><span class="pln"> </span><span class="lit">20</span><span class="pun">,</span><span class="lit">25</span><span class="pun">,</span><span class="lit">30</span><span class="pun">,</span><span class="lit">35</span><span class="pun">,</span><span class="lit">40</span><span class="pun">)</span></code></li></ol></pre><div class="md-section-divider"></div><h4 data-anchor-id="syhn" id="根据时间区间聚合">根据时间区间聚合</h4><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="llge"><ol class="linenums"><li class="L0"><code><span class="pln">SELECT online  online GROUP BY date_histogram</span><span class="pun">(</span><span class="pln">field</span><span class="pun">=</span><span class="str">'insert_time'</span><span class="pun">,</span><span class="str">'interval'</span><span class="pun">=</span><span class="str">'1d'</span><span class="pun">)</span></code></li></ol></pre></div>
</body>
</html>